"use strict";$(function(){$(document).on("click.qor.alert",'[data-dismiss="alert"]',function(){$(this).closest(".qor-alert").removeClass("qor-alert__active")}),setTimeout(function(){$('.qor-alert[data-dismissible="true"]').removeClass("qor-alert__active")},5e3)}),$(function(){$(document).on("click",".qor-dialog--global-search",function(e){e.stopPropagation(),$(e.target).parents(".qor-dialog-content").length||$(e.target).is(".qor-dialog-content")||$(".qor-dialog--global-search").remove()}),$(document).on("click",".qor-global-search--show",function(e){e.preventDefault();var t=$(this).data(),a=window.Mustache.render('<div class="qor-dialog qor-dialog--global-search" tabindex="-1" role="dialog" aria-hidden="true"><div class="qor-dialog-content"><form action=[[actionUrl]]><div class="mdl-textfield mdl-js-textfield" id="global-search-textfield"><input class="mdl-textfield__input ignore-dirtyform" name="keyword" id="globalSearch" value="" type="text" placeholder="" /><label class="mdl-textfield__label" for="globalSearch">[[placeholder]]</label></div></form></div></div>',t);$("body").append(a),window.componentHandler.upgradeElement(document.getElementById("global-search-textfield")),$("#globalSearch").focus()})}),$(function(){var s=[],i="qoradmin_menu_status",e=localStorage.getItem(i);e&&e.length&&(s=e.split(",")),$(".qor-menu-container").on("click","> ul > li a.has-submenu",function(){var e=$(this),t=e.parent(),a=e.next("ul"),o=t.attr("qor-icon-name");a.length&&(a.hasClass("in")?(s.push(o),t.removeClass("is-expanded"),a.removeClass("collapsing in")):(s=_.without(s,o),t.addClass("is-expanded"),a.addClass("collapsing in")),localStorage.setItem(i,s))}).find("> ul > li a.has-submenu").each(function(){var e=$(this),t=e.parent(),a=e.next("ul"),o=t.attr("qor-icon-name");a.length&&(a.addClass("collapse"),t.addClass("has-menu"),-1!=s.indexOf(o)||(t.addClass("is-expanded"),a.addClass("in")))});var t=$(".qor-page > .qor-page__header"),a=$(".qor-page > .qor-page__body"),o=t.find(".qor-page-subnav__header").length?96:48;t.length&&(t.height()>o&&a.css("padding-top",t.height()),$(".qor-page").addClass("has-header"),$("header.mdl-layout__header").addClass("has-action"))}),$(function(){$(".qor-mobile--show-actions").on("click",function(){$(".qor-page__header").toggleClass("actions-show")}),$("body").on("focus",".js-custom_datepicker",function(){$(this).data("is_init")||($(this).datetimepicker({format:"Y-m-d H:i:00",timepicker:!0}),$.datetimepicker.setLocale("ch"),$(this).data("is_init",!0),$(this).focus())}),$("body").on("focus",".js-date-picker",function(){$(this).data("is_init")||($(this).datetimepicker({format:"Y-m-d",timepicker:!1}),$.datetimepicker.setLocale("ch"),$(this).data("is_init",!0),$(this).focus())})}),$(function(){function u(){return p.hasClass("qor-bottomsheets-open")}var p=$("body"),g=void 0,m=void 0,f="is-selected";function q(e){$("[data-url]").removeClass(f),e&&e.length&&e.addClass(f)}p.qorBottomSheets(),p.qorSlideout(),g=p.data("qor.slideout"),m=p.data("qor.bottomsheets"),$(document).on("click.qor.openUrl","[data-url]",function(e){var t=$(this),a=$(e.target),o=t.hasClass("qor-button--new"),s=t.hasClass("qor-button--edit"),i=(t.is(".qor-table tr[data-url]")||t.closest(".qor-js-table").length)&&!t.closest(".qor-slideout").length,l=t.data(),n=void 0,r=l.openType,d=t.parents(".qor-theme-slideout").length,c=t.closest(".qor-slideout").length,h=t.hasClass("qor-action-button")||t.hasClass("qor-action--button");if(e.stopPropagation(),"window"!=r){if(!(t.data("ajax-form")||a.closest(".qor-table--bulking").length||a.closest(".qor-button--actions").length||!a.data("url")&&a.is("a")||i&&u()))return h&&(n=function(){var e=$(".qor-js-table tbody").find(".mdl-checkbox__input:checked"),t=[];return!!e.length&&(e.each(function(){t.push($(this).closest("tr").data("primary-key"))}),t)}())&&(l=$.extend({},l,{actionData:n})),l.$target=a,l.method&&"GET"!=l.method.toUpperCase()?void 0:("bottomsheet"!=r&&!h||"slideout"==r?"slideout"==r||i||o&&!u()||s?"slideout"==r||d?t.hasClass(f)?(g.hide(),q()):(g.open(l),q(t)):window.location.href=l.url:p.hasClass("qor-slideout-open")||o&&u()?m.open(l):d?g.open(l):m.open(l):h&&!n&&t.closest('[data-toggle="qor.action.bulk"]').length&&!c?window.QOR.qorConfirm(l.errorNoItem):m.open(l),!1)}else window.location.href=l.url})}),$(function(){var s=window.location;$(".qor-search").each(function(){var e=$(this),t=e.find(".qor-search__input"),a=e.find(".qor-search__clear"),o=!!t.val();e.closest(".qor-page__header").addClass("has-search"),$("header.mdl-layout__header").addClass("has-search"),a.on("click",function(){t.val()||o?"?"==s.search.replace(new RegExp(t.attr("name")+"\\=?\\w*"),"")?s.href=s.href.split("?")[0]:s.search=s.search.replace(new RegExp(t.attr("name")+"\\=?\\w*"),""):e.removeClass("is-dirty")})})});